# =========================================================
# Art -> Clipart 实验配置（启用扰动一致性）
# =========================================================
# 用法: python main.py -c configs/art2clipart_perturbation.yaml
# =========================================================

# 继承默认配置，只覆盖需要修改的项

# ============== 数据配置 ==============
data:
  root: "data/officehome"
  source: "Art"
  target: "Clipart"
  num_classes: 65
  num_workers: 0                    # Mac 上设为 0

# ============== 模型配置 ==============
model:
  backbone: "resnet50"
  pretrained: true
  bottleneck_dim: 256
  dropout: 0.5

# ============== 训练配置 ==============
train:
  # 源域训练
  source:
    epochs: 10
    batch_size: 32
    lr: 0.01
    lr_backbone: 0.001
    momentum: 0.9
    weight_decay: 0.0005
    lr_scheduler: "step"
    lr_step: 20
    lr_gamma: 0.1

  # 目标域适应
  target:
    epochs: 10
    batch_size: 64
    lr: 0.001
    lr_backbone: 0.0001
    momentum: 0.9
    weight_decay: 0.0005
    
    # SHOT 超参数
    ent_weight: 1.0
    div_weight: 1.0
    cls_weight: 0.3
    
    # 扰动一致性过滤 (启用!)
    perturbation:
      enabled: false                # 启用扰动一致性
      noise_scale: 0.2             # 高斯噪声标准差
      num_perturbations: 10        # 扰动次数
      threshold: 0.8               # 一致性阈值
      soft_weight: true            # 使用软加权（一致性作为样本权重）

# ============== 设备配置 ==============
device:
  type: "mps"

# ============== 日志配置 ==============
logging:
  log_dir: "logs"
  log_interval: 10
  save_interval: 5

# ============== 保存配置 ==============
checkpoint:
  save_dir: "checkpoints"
  save_best: true

# ============== 随机种子 ==============
seed: 2024
